<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>黄河水澄的技术专栏</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="黄河水澄的技术专栏">
<meta property="og:url" content="https://debugtheuniverse.github.io/index.html">
<meta property="og:site_name" content="黄河水澄的技术专栏">
<meta property="og:locale">
<meta property="article:author" content="Jim Huang">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="黄河水澄的技术专栏" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.1.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">黄河水澄的技术专栏</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">分享有用的知识</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Suche"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://DebugTheUniverse.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Kalman滤波" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/08/22/Kalman%E6%BB%A4%E6%B3%A2/" class="article-date">
  <time class="dt-published" datetime="2024-08-22T02:06:00.636Z" itemprop="datePublished">2024-08-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/08/22/Kalman%E6%BB%A4%E6%B3%A2/">Kalman滤波</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="Kalman滤波是什么及作用"><a href="#Kalman滤波是什么及作用" class="headerlink" title="Kalman滤波是什么及作用"></a>Kalman滤波是什么及作用</h4><p>一种通过预测值和测量值组合来滤除随机噪音和不确定性，得到当前状态的滤波方法。<br>可用于融合多个传感器、估算带噪音的数据。</p>
<p>例如一个机器人可以沿着X轴运动，在理论上，若以10m&#x2F;s的速度从0点出发向正方向运动，该机器人在1s过后将位于10m处。<br>但在实际情况中，由于轮子与地面的滑移和障碍物减缓速度的情况随机发生，1s的运动后机器人的位置是一个正态分布，其均值u&#x3D;10，σ与机器人控制精度有关。<br>与此同时，若使用传感器来测量机器人的位置，得到的结果通常也是正态分布的。</p>
<h5 id="正态分布及求和计算"><a href="#正态分布及求和计算" class="headerlink" title="正态分布及求和计算"></a>正态分布及求和计算</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">f</span><span class="params">(<span class="type">double</span> mu, <span class="type">double</span> sigma2, <span class="type">double</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//Use mu, sigma2 (sigma squared), and x to code the 1-dimensional Gaussian</span></span><br><span class="line">    <span class="comment">//Put your code here</span></span><br><span class="line">    <span class="type">double</span> prob = <span class="number">1.0</span> / <span class="built_in">sqrt</span>(<span class="number">2.0</span> * M_PI * sigma2) * <span class="built_in">exp</span>(<span class="number">-0.5</span> * <span class="built_in">pow</span>((x - mu), <span class="number">2.0</span>) / sigma2);</span><br><span class="line">    <span class="keyword">return</span> prob;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">double</span> sum = <span class="number">0.0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i != <span class="number">20</span>; ++i) &#123;</span><br><span class="line">        <span class="type">double</span> x_val = <span class="number">0.0</span> + <span class="built_in">double</span>(i);</span><br><span class="line">        <span class="type">double</span> gaussian = <span class="built_in">f</span>(<span class="number">5.0</span>, <span class="number">4.0</span>, x_val);</span><br><span class="line">        cout &lt;&lt; gaussian &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">        sum += gaussian;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//cout &lt;&lt; f(10.0, 4.0, 8.0) &lt;&lt; endl;</span></span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;sum is &quot;</span> &lt;&lt; sum &lt;&lt; endl; <span class="comment">// 接近1，类似于高斯的概率密度函数积分为1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="命名惯例"><a href="#命名惯例" class="headerlink" title="命名惯例"></a>命名惯例</h5><p>x_t 状态 state<br>z_t 测量 measurement<br>u_t 控制 control action</p>
<h5 id="测量更新-measurement-update"><a href="#测量更新-measurement-update" class="headerlink" title="测量更新 measurement update"></a>测量更新 measurement update</h5><p>例如，给机器人一个控制命令后，我们认为其位置（Prior belief）的高斯分布为mu,sigma2。<br>若此时，传感器测量得到的位置分布为v,r2，<br>那么构建融合的高斯分布是这样的：<br>新的均值：mu’ &#x3D; (r2<em>mu + sigma2</em>v)&#x2F;(r2 + sigma2)<br>新的方差：sigma2’ &#x3D; 1&#x2F;(1&#x2F;r2 + 1&#x2F;sigma2)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;tuple&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">double</span> new_mean, new_var;</span><br><span class="line"></span><br><span class="line"><span class="function">tuple&lt;<span class="type">double</span>, <span class="type">double</span>&gt; <span class="title">measurement_update</span><span class="params">(<span class="type">double</span> mean1, <span class="type">double</span> var1, <span class="type">double</span> mean2, <span class="type">double</span> var2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    new_mean = (var2 * mean1 + var1 * mean2) / (var1 + var2);</span><br><span class="line">    new_var = <span class="number">1</span> / (<span class="number">1</span> / var1 + <span class="number">1</span> / var2);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">make_tuple</span>(new_mean, new_var);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">tie</span>(new_mean, new_var) = <span class="built_in">measurement_update</span>(<span class="number">10</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[%f, %f]&quot;</span>, new_mean, new_var);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="状态预测"><a href="#状态预测" class="headerlink" title="状态预测"></a>状态预测</h5><p>在知道当前先验位置分布mu1,sigma2(1)的时候（sigma2表示sigma的平方），给出运动控制指令的先验作用效果分布mu2,sigma2(2),<br>预测其状态的公式如下：<br>后验均值 Posterior Mean  mu’ &#x3D; mu1 + mu2<br>后验方差 Posterior Variance sigma2’ &#x3D; sigma2(1) + sigma2(2)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;tuple&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">double</span> new_mean, new_var;</span><br><span class="line"></span><br><span class="line"><span class="function">tuple&lt;<span class="type">double</span>, <span class="type">double</span>&gt; <span class="title">state_prediction</span><span class="params">(<span class="type">double</span> mean1, <span class="type">double</span> var1, <span class="type">double</span> mean2, <span class="type">double</span> var2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    new_mean = mean1 + mean2;</span><br><span class="line">    new_var =  var1 + var2;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">make_tuple</span>(new_mean, new_var);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">tie</span>(new_mean, new_var) = <span class="built_in">state_prediction</span>(<span class="number">10</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">4</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[%f, %f]&quot;</span>, new_mean, new_var);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1D-Kalman-滤波代码"><a href="#1D-Kalman-滤波代码" class="headerlink" title="1D Kalman 滤波代码"></a>1D Kalman 滤波代码</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;tuple&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">double</span> new_mean, new_var;</span><br><span class="line"></span><br><span class="line"><span class="function">tuple&lt;<span class="type">double</span>, <span class="type">double</span>&gt; <span class="title">measurement_update</span><span class="params">(<span class="type">double</span> mean1, <span class="type">double</span> var1, <span class="type">double</span> mean2, <span class="type">double</span> var2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    new_mean = (var2 * mean1 + var1 * mean2) / (var1 + var2);</span><br><span class="line">    new_var = <span class="number">1</span> / (<span class="number">1</span> / var1 + <span class="number">1</span> / var2);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">make_tuple</span>(new_mean, new_var);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">tuple&lt;<span class="type">double</span>, <span class="type">double</span>&gt; <span class="title">state_prediction</span><span class="params">(<span class="type">double</span> mean1, <span class="type">double</span> var1, <span class="type">double</span> mean2, <span class="type">double</span> var2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    new_mean = mean1 + mean2;</span><br><span class="line">    new_var = var1 + var2;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">make_tuple</span>(new_mean, new_var);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//Measurements and measurement variance</span></span><br><span class="line">    <span class="type">double</span> measurements[<span class="number">5</span>] = &#123; <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span> &#125;;</span><br><span class="line">    <span class="type">double</span> measurement_sig = <span class="number">4</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//Motions and motion variance</span></span><br><span class="line">    <span class="type">double</span> motion[<span class="number">5</span>] = &#123; <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="type">double</span> motion_sig = <span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//Initial state</span></span><br><span class="line">    <span class="type">double</span> mu = <span class="number">0</span>;</span><br><span class="line">    <span class="type">double</span> sig = <span class="number">1000</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//######<span class="doctag">TODO:</span> Put your code here below this line######//</span></span><br><span class="line">    <span class="comment">// Loop through all the measurments</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">sizeof</span>(measurements)/<span class="built_in">sizeof</span>(measurements[<span class="number">0</span>]); i++)&#123;</span><br><span class="line">        <span class="comment">// Apply a measurment update</span></span><br><span class="line">        <span class="built_in">tie</span>(mu, sig) = <span class="built_in">measurement_update</span>(mu, sig, measurements[i], measurement_sig);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;update:  [%f, %f]\n&quot;</span>, mu, sig);</span><br><span class="line">        <span class="comment">// Apply a state prediction</span></span><br><span class="line">        <span class="built_in">tie</span>(mu, sig) = <span class="built_in">state_prediction</span>(mu, sig, motion[i], motion_sig);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;predict: [%f, %f]\n&quot;</span>, mu, sig);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="多维度卡尔曼滤波"><a href="#多维度卡尔曼滤波" class="headerlink" title="多维度卡尔曼滤波"></a>多维度卡尔曼滤波</h4><h5 id="2d高斯"><a href="#2d高斯" class="headerlink" title="2d高斯"></a>2d高斯</h5><p>均值：一个均值组成的向量<br>方差：协方差矩阵，其对角线为方差，二维图像上与椭圆的长短轴相关；对角线之外的是相关项，与椭圆转动有关，正值向右转。</p>
<p>维度中变量的组合可是位置组合如[x, y]’,也可以是位置与速度组合如[x, x’]’</p>
<p>变量分为可见变量和隐藏变量，比如机器人的位置传感器获取其位置是可见变量，而其速度是可以通过位置与时间的关系得到的隐藏变量。<br>通过重复进行状态预测和测量更新，可以达到比单独传感更小的方差分布。</p>
<h5 id="卡尔曼滤波例子"><a href="#卡尔曼滤波例子" class="headerlink" title="卡尔曼滤波例子"></a>卡尔曼滤波例子</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;tuple&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;eigen/eigen/Core&quot;</span> <span class="comment">// Eigen Library</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;eigen/eigen/LU&quot;</span>   <span class="comment">// Eigen Library</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Eigen;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> measurements[<span class="number">3</span>] = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">tuple&lt;MatrixXf, MatrixXf&gt; <span class="title">kalman_filter</span><span class="params">(MatrixXf x, MatrixXf P, MatrixXf u, MatrixXf F, MatrixXf H, MatrixXf R, MatrixXf I)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> n = <span class="number">0</span>; n &lt; <span class="built_in">sizeof</span>(measurements) / <span class="built_in">sizeof</span>(measurements[<span class="number">0</span>]); n++) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Measurement Update</span></span><br><span class="line">        <span class="function">MatrixXf <span class="title">Z</span><span class="params">(<span class="number">1</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">        Z &lt;&lt; measurements[n];</span><br><span class="line"></span><br><span class="line">        <span class="function">MatrixXf <span class="title">y</span><span class="params">(<span class="number">1</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">        y &lt;&lt; Z - (H * x);</span><br><span class="line"></span><br><span class="line">        <span class="function">MatrixXf <span class="title">S</span><span class="params">(<span class="number">1</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">        S &lt;&lt; H * P * H.<span class="built_in">transpose</span>() + R;</span><br><span class="line"></span><br><span class="line">        <span class="function">MatrixXf <span class="title">K</span><span class="params">(<span class="number">2</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">        K &lt;&lt; P * H.<span class="built_in">transpose</span>() * S.<span class="built_in">inverse</span>();</span><br><span class="line"></span><br><span class="line">        x &lt;&lt; x + (K * y);</span><br><span class="line"></span><br><span class="line">        P &lt;&lt; (I - (K * H)) * P;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Prediction</span></span><br><span class="line">        x &lt;&lt; (F * x) + u;</span><br><span class="line">        P &lt;&lt; F * P * F.<span class="built_in">transpose</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">make_tuple</span>(x, P);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">MatrixXf <span class="title">x</span><span class="params">(<span class="number">2</span>, <span class="number">1</span>)</span></span>;<span class="comment">// Initial state (location and velocity) </span></span><br><span class="line">    x &lt;&lt; <span class="number">0</span>,</span><br><span class="line">    	 <span class="number">0</span>; </span><br><span class="line">    <span class="function">MatrixXf <span class="title">P</span><span class="params">(<span class="number">2</span>, <span class="number">2</span>)</span></span>;<span class="comment">//Initial Uncertainty</span></span><br><span class="line">    P &lt;&lt; <span class="number">100</span>, <span class="number">0</span>, </span><br><span class="line">    	 <span class="number">0</span>, <span class="number">100</span>; </span><br><span class="line">    <span class="function">MatrixXf <span class="title">u</span><span class="params">(<span class="number">2</span>, <span class="number">1</span>)</span></span>;<span class="comment">// External Motion</span></span><br><span class="line">    u &lt;&lt; <span class="number">0</span>,</span><br><span class="line">    	 <span class="number">0</span>; </span><br><span class="line">    <span class="function">MatrixXf <span class="title">F</span><span class="params">(<span class="number">2</span>, <span class="number">2</span>)</span></span>;<span class="comment">//Next State Function</span></span><br><span class="line">    F &lt;&lt; <span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">    	 <span class="number">0</span>, <span class="number">1</span>; </span><br><span class="line">    <span class="function">MatrixXf <span class="title">H</span><span class="params">(<span class="number">1</span>, <span class="number">2</span>)</span></span>;<span class="comment">//Measurement Function</span></span><br><span class="line">    H &lt;&lt; <span class="number">1</span>,</span><br><span class="line">    	 <span class="number">0</span>; </span><br><span class="line">    <span class="function">MatrixXf <span class="title">R</span><span class="params">(<span class="number">1</span>, <span class="number">1</span>)</span></span>; <span class="comment">//Measurement Uncertainty</span></span><br><span class="line">    R &lt;&lt; <span class="number">1</span>;</span><br><span class="line">    <span class="function">MatrixXf <span class="title">I</span><span class="params">(<span class="number">2</span>, <span class="number">2</span>)</span></span>;<span class="comment">// Identity Matrix</span></span><br><span class="line">    I &lt;&lt; <span class="number">1</span>, <span class="number">0</span>,</span><br><span class="line">    	 <span class="number">0</span>, <span class="number">1</span>; </span><br><span class="line"></span><br><span class="line">    <span class="built_in">tie</span>(x, P) = <span class="built_in">kalman_filter</span>(x, P, u, F, H, R, I);</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;x= &quot;</span> &lt;&lt; x &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;P= &quot;</span> &lt;&lt; P &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Kalman滤波的类型"><a href="#Kalman滤波的类型" class="headerlink" title="Kalman滤波的类型"></a>Kalman滤波的类型</h4><p>KF-线性<br>EKF-非线性<br>UKF-高度非线性</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://debugtheuniverse.github.io/2024/08/22/Kalman%E6%BB%A4%E6%B3%A2/" data-id="cm04p1s150000nguk0dov0uhc" data-title="Kalman滤波" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Python advanced" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/05/14/Python%20advanced/" class="article-date">
  <time class="dt-published" datetime="2024-05-14T07:23:15.549Z" itemprop="datePublished">2024-05-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<h2 id="Python-advanced"><a href="#Python-advanced" class="headerlink" title="Python advanced"></a>Python advanced</h2><h3 id="decorator"><a href="#decorator" class="headerlink" title="decorator"></a>decorator</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mydecorator</span>(<span class="params">function</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        function(*args, **kwargs)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; I am decorating your funciton!&quot;</span>)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@mydecorator</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Hello <span class="subst">&#123;name&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">hello_world(<span class="string">&quot;mike&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="Example-1-保存调试信息"><a href="#Example-1-保存调试信息" class="headerlink" title="Example 1 保存调试信息"></a>Example 1 保存调试信息</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">logged</span>(<span class="params">function</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        value = function(*args, **kwargs)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;logfile.txt&quot;</span>, <span class="string">&quot;a+&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            fname = function.__name__</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;fname&#125;</span> returned value <span class="subst">&#123;value&#125;</span>&quot;</span>)</span><br><span class="line">            f.write(<span class="string">f&quot;<span class="subst">&#123;fname&#125;</span> returned value <span class="subst">&#123;value&#125;</span>\n&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line">    </span><br><span class="line"><span class="meta">@logged</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(add(<span class="number">10</span>, <span class="number">20</span>))</span><br></pre></td></tr></table></figure>

<h4 id="Example-2-计时"><a href="#Example-2-计时" class="headerlink" title="Example 2 计时"></a>Example 2 计时</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">timed</span>(<span class="params">function</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">        before = time.time()</span><br><span class="line">        value = function(*args, **kwargs)</span><br><span class="line">        after = time.time()</span><br><span class="line">        fname = function.__name__</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;fname&#125;</span> took <span class="subst">&#123;after - before&#125;</span> seconds to execute!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@timed</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myfunction</span>(<span class="params">x</span>):</span><br><span class="line">    result = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, x):</span><br><span class="line">        result *= i</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">myfunction(<span class="number">1000</span>)</span><br></pre></td></tr></table></figure>

<h3 id="generator"><a href="#generator" class="headerlink" title="generator"></a>generator</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">infinite_sequence</span>():</span><br><span class="line">    result = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">yield</span> result</span><br><span class="line">        result *= <span class="number">5</span></span><br><span class="line"></span><br><span class="line">values = infinite_sequence()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">next</span>(values))</span><br></pre></td></tr></table></figure>

<h3 id="argument-parsing"><a href="#argument-parsing" class="headerlink" title="argument parsing"></a>argument parsing</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="comment"># Usage: python test.py filename</span></span><br><span class="line"></span><br><span class="line">filename = sys.argv[<span class="number">1</span>]</span><br><span class="line">message = sys.argv[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&quot;w+&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(message)</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> getopt</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;text.txt&quot;</span></span><br><span class="line">message = <span class="string">&quot;Hello&quot;</span></span><br><span class="line"></span><br><span class="line">opts, args = getopt.getopt(sys.argv[<span class="number">1</span>:],<span class="string">&quot;f:m:&quot;</span>, [<span class="string">&quot;filename&quot;</span>, <span class="string">&quot;message&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> opt, arg <span class="keyword">in</span> opts:</span><br><span class="line">    <span class="keyword">if</span> opt == <span class="string">&#x27;-f&#x27;</span>:</span><br><span class="line">        filename = arg</span><br><span class="line">    <span class="keyword">if</span> opt == <span class="string">&#x27;-m&#x27;</span>:</span><br><span class="line">        message = arg</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&quot;w+&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(message)</span><br></pre></td></tr></table></figure>

<h3 id="encapsulation"><a href="#encapsulation" class="headerlink" title="encapsulation"></a>encapsulation</h3><p>没有直接范围隐藏数据成员</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age, gender</span>):</span><br><span class="line"></span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__age = age</span><br><span class="line">        self.__gender = gender</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Name</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.__name</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @Name.setter </span><span class="comment"># python 没有重载，只有这种</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Name</span>(<span class="params">self, value</span>):</span><br><span class="line">        <span class="keyword">if</span> value == <span class="string">&#x27;Bob&#x27;</span>:<span class="comment"># 统一处理访问</span></span><br><span class="line">            self.__name = <span class="string">&#x27;Defult name&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.__name = value</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mymethod</span>():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Hello World from static method!&quot;</span>)</span><br><span class="line"></span><br><span class="line">Person.mymethod()</span><br><span class="line"></span><br><span class="line">p1 = Person(<span class="string">&#x27;mike&#x27;</span>, <span class="number">27</span>, <span class="string">&#x27;male&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(p1.Name)</span><br><span class="line"></span><br><span class="line">p1.Name = <span class="string">&#x27;john&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(p1.Name)</span><br></pre></td></tr></table></figure>

<h3 id="Type-hinting"><a href="#Type-hinting" class="headerlink" title="Type hinting"></a>Type hinting</h3><p>使用mypy做类型检查</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mypy .\test.py</span><br></pre></td></tr></table></figure>
<p>使用显式类型标注</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">myfunction</span>(<span class="params">myparameter:<span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">return</span> myparameter + <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(myfunction(<span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dosth</span>(<span class="params">param: <span class="built_in">list</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">list</span>[<span class="built_in">int</span>]:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(param)):</span><br><span class="line">        param[i] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> param</span><br><span class="line"></span><br><span class="line">l = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(dosth(l))</span><br></pre></td></tr></table></figure>

<h3 id="Magic-methods"><a href="#Magic-methods" class="headerlink" title="Magic methods"></a>Magic methods</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Vector</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, x, y</span>):</span><br><span class="line">        self.x = x</span><br><span class="line">        self.y = y</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span>(Vector(self.x + other.x, self.y + other.y))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;X: <span class="subst">&#123;self.x&#125;</span>, Y: <span class="subst">&#123;self.y&#125;</span>&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Hello! I was called!&quot;</span>)</span><br><span class="line"></span><br><span class="line">v1 = Vector(<span class="number">10</span>,<span class="number">20</span>)</span><br><span class="line">v2 = Vector(<span class="number">50</span>,<span class="number">40</span>)</span><br><span class="line">v3 = v1 + v2</span><br><span class="line"><span class="built_in">print</span>(v3)</span><br><span class="line">v3()</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://debugtheuniverse.github.io/2024/05/14/Python%20advanced/" data-id="cm04p1s1i0002ngukc1uw9z7q" data-title="" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-配置Qt与OpenCV" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/05/13/%E9%85%8D%E7%BD%AEQt%E4%B8%8EOpenCV/" class="article-date">
  <time class="dt-published" datetime="2024-05-13T11:26:00.146Z" itemprop="datePublished">2024-05-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/05/13/%E9%85%8D%E7%BD%AEQt%E4%B8%8EOpenCV/">配置Qt与OpenCV</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wangz76/article/details/124641714">教程</a></p>
<p>碰到错误</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Fatal error: can&#x27;t write 9 bytes to section .text$_ZNSt14numeric_limitsIfE9quiet_NaNEv of CMakeFiles\opencv_perf_core.dir\perf\opencl\perf_arithm.cpp.obj: &#x27;file too big&#x27;</span><br></pre></td></tr></table></figure>
<p>解决方案<br>在<br>“C:\dev\opencv-4.5.2\release\CMakeFiles\3.21.0-rc2\CMakeCXXCompiler.cmake”<br>增加<br>set(CMAKE_CXX_FLAGS ${CMAKE_CXX_FLAGS} “-O3”)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://debugtheuniverse.github.io/2024/05/13/%E9%85%8D%E7%BD%AEQt%E4%B8%8EOpenCV/" data-id="cm04p1s1l0004nguk5f53aoum" data-title="配置Qt与OpenCV" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Python 赋值引用、拷贝" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/05/06/Python%20%E8%B5%8B%E5%80%BC%E5%BC%95%E7%94%A8%E3%80%81%E6%8B%B7%E8%B4%9D/" class="article-date">
  <time class="dt-published" datetime="2024-05-06T14:59:58.961Z" itemprop="datePublished">2024-05-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/05/06/Python%20%E8%B5%8B%E5%80%BC%E5%BC%95%E7%94%A8%E3%80%81%E6%8B%B7%E8%B4%9D/">Python 赋值引用、拷贝</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>参考文章<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/265179766">link</a></p>
<h4 id="变量和对象之间的关系为引用"><a href="#变量和对象之间的关系为引用" class="headerlink" title="变量和对象之间的关系为引用"></a>变量和对象之间的关系为引用</h4><p>1 第一次赋值时，即创建，之后 再次赋值 将会 改变 变量的值。<br>2 变量名本身是没有类型的，类型只存在对象中，变量只是引用了对象。<br>3 所有的变量，必须 在使用前 赋值，使用未赋值的变量会产生错误。</p>
<h4 id="Python对象三要素：Id，Type，Value"><a href="#Python对象三要素：Id，Type，Value" class="headerlink" title="Python对象三要素：Id，Type，Value"></a>Python对象三要素：Id，Type，Value</h4><p>Id：唯一标识一个对象<br>Type：标识对象的类型<br>Value：对象的值<br>&#x3D;&#x3D; 指值相等。<br>is 指地址相等，即指引用相等。</p>
<p>变量是一个系统表的元素，拥有指向对象的连接的空间。<br>对象是分配的一块内存，有足够的空间去表示它们所代表的值。<br>引用是自动形成的从变量到对象的指针。</p>
<h4 id="python里面复制对象时因对象而异，如list"><a href="#python里面复制对象时因对象而异，如list" class="headerlink" title="python里面复制对象时因对象而异，如list"></a>python里面复制对象时因对象而异，如list</h4><p>values[:] 复制操作是所谓的「浅复制」(shallow copy)<br>存在问题:当被复制的list里有引用元素时，浅复制后的list中还是会共享改引用，导致相互干扰</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0</span>, [<span class="number">1</span>, <span class="number">2</span>], <span class="number">3</span>]</span><br><span class="line">b = a[:]</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">8</span></span><br><span class="line">a[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">9</span></span><br><span class="line"><span class="comment">#a 为 [8, [1, 9], 3]，</span></span><br><span class="line"><span class="comment">#b 为 [0, [1, 9], 3]。</span></span><br></pre></td></tr></table></figure>


<h4 id="正确复制嵌套元素是进行“深复制”（deep-copy）"><a href="#正确复制嵌套元素是进行“深复制”（deep-copy）" class="headerlink" title="正确复制嵌套元素是进行“深复制”（deep copy）"></a>正确复制嵌套元素是进行“深复制”（deep copy）</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"> </span><br><span class="line">a = [<span class="number">0</span>, [<span class="number">1</span>, <span class="number">2</span>], <span class="number">3</span>]</span><br><span class="line">b = copy.deepcopy(a)</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">8</span></span><br><span class="line">a[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">9</span></span><br></pre></td></tr></table></figure>

<h4 id="引用和拷贝"><a href="#引用和拷贝" class="headerlink" title="引用和拷贝"></a>引用和拷贝</h4><p>没有限制条件的分片表达式（L[:]）能够复制序列，但此法只能浅层复制。</p>
<p>字典 copy 方法，D.copy() 能够复制字典，但此法只能浅层复制。</p>
<p>有些内置函数，例如 list，能够生成拷贝 list(L)。</p>
<p>copy 标准库模块能够生成完整拷贝：deepcopy 本质上是递归 copy。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://debugtheuniverse.github.io/2024/05/06/Python%20%E8%B5%8B%E5%80%BC%E5%BC%95%E7%94%A8%E3%80%81%E6%8B%B7%E8%B4%9D/" data-id="cm04p1s1j0003nguk0apw28wm" data-title="Python 赋值引用、拷贝" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-C++基础" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/05/04/C++%E5%9F%BA%E7%A1%80/" class="article-date">
  <time class="dt-published" datetime="2024-05-04T02:03:53.198Z" itemprop="datePublished">2024-05-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/05/04/C++%E5%9F%BA%E7%A1%80/">C++ 基础</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="public-protected-private"><a href="#public-protected-private" class="headerlink" title="public protected private"></a>public protected private</h4><p>public在任何地方都能访问。proteted和private不能被实例访问，但可以被友元函数访问。</p>
<p>public继承，基类权限不变；派生类成员函数可访问基类public和protected，不能访问private</p>
<p>protected继承，基类的public成员在派生类中的权限变成了protected；派生类成员函数可访问基类public和protected，不能访问private。</p>
<p>private继承，基类的所有成员在派生类中的权限变成了private；派生类成员函数可访问基类public、protected，不能访问基类private成员。</p>
<h4 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h4><p>使用<code>std::thread</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print_sum</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;The sum is: &quot;</span> &lt;&lt; a + b &lt;&lt; std::endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::thread <span class="title">t</span><span class="params">(print_sum, <span class="number">3</span>, <span class="number">5</span>)</span></span>;</span><br><span class="line">    t.<span class="built_in">join</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当出现线程之间资源竞争时，需要用mutex锁</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"></span><br><span class="line">std::mutex mtx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print_block</span><span class="params">(<span class="type">int</span> n, <span class="type">char</span> c)</span> </span>&#123;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">std::unique_lock&lt;std::mutex&gt; <span class="title">locker</span><span class="params">(mtx)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            std::cout &lt;&lt; c;</span><br><span class="line">        &#125;</span><br><span class="line">        std::cout &lt;&lt; std::endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::thread <span class="title">t1</span><span class="params">(print_block, <span class="number">50</span>, <span class="string">&#x27;*&#x27;</span>)</span></span>;</span><br><span class="line">    <span class="function">std::thread <span class="title">t2</span><span class="params">(print_block, <span class="number">50</span>, <span class="string">&#x27;$&#x27;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    t1.<span class="built_in">join</span>();</span><br><span class="line">    t2.<span class="built_in">join</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://debugtheuniverse.github.io/2024/05/04/C++%E5%9F%BA%E7%A1%80/" data-id="cm04p1s1g0001ngukdc2vd5gq" data-title="C++ 基础" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-目标检测Datasets格式" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/04/24/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8BDatasets%E6%A0%BC%E5%BC%8F/" class="article-date">
  <time class="dt-published" datetime="2024-04-24T02:43:03.423Z" itemprop="datePublished">2024-04-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/04/24/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8BDatasets%E6%A0%BC%E5%BC%8F/">目标检测Datasets格式</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="Ultralytics-YOLO-格式"><a href="#Ultralytics-YOLO-格式" class="headerlink" title="Ultralytics YOLO 格式"></a>Ultralytics YOLO 格式</h4><ol>
<li>每个图对应一个txt文件，与图同名</li>
<li>在txt中：每行对应一个目标物件</li>
<li>在行中有:</li>
</ol>
<ul>
<li>类别索引，用数字表示的类别（如，0是person，1是car，等）</li>
<li>Mask区域的边界点坐标，用归一化的数字表示<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;class-index&gt; &lt;x1&gt; &lt;y1&gt; &lt;x2&gt; &lt;y2&gt; ... &lt;xn&gt; &lt;yn&gt;</span><br></pre></td></tr></table></figure>
每行的长度不一定相同，如果是作为分割任务，最少要有三个xy坐标点</li>
</ul>
<h4 id="YAML格式"><a href="#YAML格式" class="headerlink" title="YAML格式"></a>YAML格式</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Train/val/test sets as 1) dir: path/to/imgs, 2) file: path/to/imgs.txt, or 3) list: [path/to/imgs1, path/to/imgs2, ..]</span></span><br><span class="line"><span class="attr">path:</span> <span class="string">../datasets/coco8-seg</span>  <span class="comment"># dataset root dir</span></span><br><span class="line"><span class="attr">train:</span> <span class="string">images/train</span>  <span class="comment"># train images (relative to &#x27;path&#x27;) 4 images</span></span><br><span class="line"><span class="attr">val:</span> <span class="string">images/val</span>  <span class="comment"># val images (relative to &#x27;path&#x27;) 4 images</span></span><br><span class="line"><span class="attr">test:</span>  <span class="comment"># test images (optional)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Classes (80 COCO classes)</span></span><br><span class="line"><span class="attr">names:</span></span><br><span class="line">  <span class="attr">0:</span> <span class="string">person</span></span><br><span class="line">  <span class="attr">1:</span> <span class="string">bicycle</span></span><br><span class="line">  <span class="attr">2:</span> <span class="string">car</span></span><br><span class="line">  <span class="comment"># ...</span></span><br><span class="line">  <span class="attr">77:</span> <span class="string">teddy</span> <span class="string">bear</span></span><br><span class="line">  <span class="attr">78:</span> <span class="string">hair</span> <span class="string">drier</span></span><br><span class="line">  <span class="attr">79:</span> <span class="string">toothbrush</span></span><br></pre></td></tr></table></figure>
<p>这里的<code>train</code>和<code>val</code>分别指的是训练和验证数据的存储位置<br><code>names</code>是类别名称的字典，序号与YOLO格式数据里面的对应</p>
<h4 id="使用方法-python"><a href="#使用方法-python" class="headerlink" title="使用方法 python"></a>使用方法 python</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ultralytics <span class="keyword">import</span> YOLO</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load a model</span></span><br><span class="line">model = YOLO(<span class="string">&#x27;yolov8n-seg.pt&#x27;</span>)  <span class="comment"># load a pretrained model (recommended for training)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Train the model</span></span><br><span class="line">results = model.train(data=<span class="string">&#x27;coco8-seg.yaml&#x27;</span>, epochs=<span class="number">100</span>, imgsz=<span class="number">640</span>)</span><br></pre></td></tr></table></figure>

<h4 id="使用方法-CLI"><a href="#使用方法-CLI" class="headerlink" title="使用方法 CLI"></a>使用方法 CLI</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Start training from a pretrained *.pt model</span></span><br><span class="line">yolo detect train data=coco8-seg.yaml model=yolov8n-seg.pt epochs=100 imgsz=640</span><br></pre></td></tr></table></figure>

<h4 id="自动标注功能"><a href="#自动标注功能" class="headerlink" title="自动标注功能"></a>自动标注功能</h4><p>使用SAM模型自动标注</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ultralytics.data.annotator <span class="keyword">import</span> auto_annotate</span><br><span class="line"></span><br><span class="line">auto_annotate(data=<span class="string">&quot;path/to/images&quot;</span>, det_model=<span class="string">&quot;yolov8x.pt&quot;</span>, sam_model=<span class="string">&#x27;sam_b.pt&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>Argument	Type	Description	Default<br>data	待标注的数据<br>det_model	预训练的检测模型 Defaults to ‘yolov8x.pt’.	‘yolov8x.pt’<br>sam_model	预训练的SAM模型 Defaults to ‘sam_b.pt’.	‘sam_b.pt’<br>device	运行设备. Defaults to an empty string (CPU or GPU, if available).	‘’<br>output_dir	保存标注结果的路径. Defaults to a ‘labels’ folder in the same directory as ‘data’.	None</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://debugtheuniverse.github.io/2024/04/24/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8BDatasets%E6%A0%BC%E5%BC%8F/" data-id="clvg47z9w000120uk3pr10hgq" data-title="目标检测Datasets格式" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-计算机视觉常用概念" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/04/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89%E5%B8%B8%E7%94%A8%E6%A6%82%E5%BF%B5/" class="article-date">
  <time class="dt-published" datetime="2024-04-21T02:42:49.690Z" itemprop="datePublished">2024-04-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/04/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89%E5%B8%B8%E7%94%A8%E6%A6%82%E5%BF%B5/">计算机视觉常用概念</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="IoU-交并比"><a href="#IoU-交并比" class="headerlink" title="IoU 交并比"></a>IoU 交并比</h3><p>给定<code>pred_bbox</code>和<code>gt_bbox</code>，计算交集面积与并集的比值。<br>bbox的表示方法是<code>[x1,y1,x2,y2]</code></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_IoU</span>(<span class="params">pred_bbox, gt_bbox</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param pred_bbox: predicted bbox coordinate</span></span><br><span class="line"><span class="string">    :param gt_bbox: ground truth bbox coordinate</span></span><br><span class="line"><span class="string">    :return: iou score</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    ix1 = <span class="built_in">max</span>(pred_bbox[<span class="number">0</span>], gt_bbox[<span class="number">0</span>])</span><br><span class="line">    iy1 = <span class="built_in">max</span>(pred_bbox[<span class="number">1</span>], gt_bbox[<span class="number">1</span>])</span><br><span class="line">    ix2 = <span class="built_in">min</span>(pred_bbox[<span class="number">2</span>], gt_bbox[<span class="number">2</span>])</span><br><span class="line">    iy2 = <span class="built_in">min</span>(pred_bbox[<span class="number">3</span>], gt_bbox[<span class="number">3</span>])</span><br><span class="line">    iw = np.maximum(ix2 - ix1 + <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    ih = np.maximum(iy2 - iy1 + <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    inter = iw * ih</span><br><span class="line"></span><br><span class="line">    union = (pred_bbox[<span class="number">2</span>] - pred_bbox[<span class="number">0</span>]) * (pred_bbox[<span class="number">3</span>] - pred_bbox[<span class="number">1</span>]) + (gt_bbox[<span class="number">2</span>] - gt_bbox[<span class="number">0</span>]) * (gt_bbox[<span class="number">3</span>] - gt_bbox[<span class="number">1</span>]) - inter</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inter / union</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_max_IoU</span>(<span class="params">pred_bboxes, gt_bbox</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    given 1 gt bbox, &gt;1 pred bboxes, return max iou score for the given gt bbox and pred_bboxes</span></span><br><span class="line"><span class="string">    :param pred_bbox: predict bboxes coordinates, we need to find the max iou score with gt bbox for these pred bboxes</span></span><br><span class="line"><span class="string">    :param gt_bbox: ground truth bbox coordinate</span></span><br><span class="line"><span class="string">    :return: max iou score</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> pred_bboxes.shape[<span class="number">0</span>] &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># -----0---- get coordinates of inters, but with multiple predict bboxes</span></span><br><span class="line">        ix1 = np.maximum(pred_bboxes[:, <span class="number">0</span>], gt_bbox[<span class="number">0</span>])</span><br><span class="line">        iy1 = np.maximum(pred_bboxes[:, <span class="number">1</span>], gt_bbox[<span class="number">1</span>])</span><br><span class="line">        ix2 = np.minimum(pred_bboxes[:, <span class="number">2</span>], gt_bbox[<span class="number">2</span>])</span><br><span class="line">        iy2 = np.minimum(pred_bboxes[:, <span class="number">3</span>], gt_bbox[<span class="number">3</span>])</span><br><span class="line">        iw = np.maximum(ix2 - ix1 + <span class="number">1.</span>, <span class="number">0.</span>) <span class="comment"># max用于过滤无交集情况，+1是当出现边界框边缘接触的时候留下数值</span></span><br><span class="line">        ih = np.maximum(iy2 - iy1 + <span class="number">1.</span>, <span class="number">0.</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># -----1----- intersection</span></span><br><span class="line">        inters = iw * ih</span><br><span class="line"></span><br><span class="line">        <span class="comment"># -----2----- union, uni = S1 + S2 - inters</span></span><br><span class="line">        uni = ((gt_bbox[<span class="number">2</span>] - gt_bbox[<span class="number">0</span>] + <span class="number">1.</span>) * (gt_bbox[<span class="number">3</span>] - gt_bbox[<span class="number">1</span>] + <span class="number">1.</span>) +</span><br><span class="line">               (pred_bboxes[:, <span class="number">2</span>] - pred_bboxes[:, <span class="number">0</span>] + <span class="number">1.</span>) * (pred_bboxes[:, <span class="number">3</span>] - pred_bboxes[:, <span class="number">1</span>] + <span class="number">1.</span>) -</span><br><span class="line">               inters)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># -----3----- iou, get max score and max iou index</span></span><br><span class="line">        overlaps = inters / uni</span><br><span class="line">        ovmax = np.<span class="built_in">max</span>(overlaps)</span><br><span class="line">        jmax = np.argmax(overlaps)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> overlaps, ovmax, jmax</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># test1</span></span><br><span class="line">    pred_bbox = np.array([<span class="number">50</span>, <span class="number">50</span>, <span class="number">90</span>, <span class="number">100</span>])   <span class="comment"># top-left: &lt;50, 50&gt;, bottom-down: &lt;90, 100&gt;, &lt;x-axis, y-axis&gt;</span></span><br><span class="line">    gt_bbox = np.array([<span class="number">110</span>, <span class="number">110</span>, <span class="number">150</span>, <span class="number">150</span>])</span><br><span class="line">    <span class="built_in">print</span> (get_IoU(pred_bbox, gt_bbox))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># test2</span></span><br><span class="line">    pred_bboxes = np.array([[<span class="number">15</span>, <span class="number">18</span>, <span class="number">47</span>, <span class="number">60</span>],</span><br><span class="line">                          [<span class="number">50</span>, <span class="number">50</span>, <span class="number">90</span>, <span class="number">100</span>],</span><br><span class="line">                          [<span class="number">70</span>, <span class="number">80</span>, <span class="number">120</span>, <span class="number">145</span>],</span><br><span class="line">                          [<span class="number">130</span>, <span class="number">160</span>, <span class="number">250</span>, <span class="number">280</span>],</span><br><span class="line">                          [<span class="number">25.6</span>, <span class="number">66.1</span>, <span class="number">113.3</span>, <span class="number">147.8</span>]])</span><br><span class="line">    gt_bbox = np.array([<span class="number">70</span>, <span class="number">80</span>, <span class="number">120</span>, <span class="number">150</span>])</span><br><span class="line">    <span class="built_in">print</span> (get_max_IoU(pred_bboxes, gt_bbox))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="NMS-非极大值抑制"><a href="#NMS-非极大值抑制" class="headerlink" title="NMS 非极大值抑制"></a>NMS 非极大值抑制</h3><p>预测结果可能是这样的<br>x1, y1, x2, y2, score, class;<br>x1, y1, x2, y2, score, class;</p>
<ol>
<li>按score降序排列</li>
<li>提取bboxes，即<code>x1, y1, x2, y2</code>组成的矩阵</li>
<li>计算IoU</li>
<li>新建一个空矩阵，将原来的结果矩阵中高IoU和重复名称的取出放入，在剩下的里面重复取高IoU和重名的<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> draw_bbox <span class="keyword">import</span> draw_box</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nms</span>(<span class="params">bboxes, scores, iou_thresh</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param bboxes: 检测框列表</span></span><br><span class="line"><span class="string">    :param scores: 置信度列表</span></span><br><span class="line"><span class="string">    :param iou_thresh: IOU阈值</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    x1 = bboxes[:, <span class="number">0</span>]</span><br><span class="line">    y1 = bboxes[:, <span class="number">1</span>]</span><br><span class="line">    x2 = bboxes[:, <span class="number">2</span>]</span><br><span class="line">    y2 = bboxes[:, <span class="number">3</span>]</span><br><span class="line">    areas = (y2 - y1) * (x2 - x1)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 结果列表</span></span><br><span class="line">    result = []</span><br><span class="line">    index = scores.argsort()[::-<span class="number">1</span>]  <span class="comment"># 对检测框按照置信度进行从高到低的排序，并获取索引</span></span><br><span class="line">    <span class="comment"># 下面的操作为了安全，都是对索引处理</span></span><br><span class="line">    <span class="keyword">while</span> index.size &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># 当检测框不为空一直循环</span></span><br><span class="line">        i = index[<span class="number">0</span>]</span><br><span class="line">        result.append(i)  <span class="comment"># 将置信度最高的加入结果列表</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算其他边界框与该边界框的IOU</span></span><br><span class="line">        x11 = np.maximum(x1[i], x1[index[<span class="number">1</span>:]])</span><br><span class="line">        y11 = np.maximum(y1[i], y1[index[<span class="number">1</span>:]])</span><br><span class="line">        x22 = np.minimum(x2[i], x2[index[<span class="number">1</span>:]])</span><br><span class="line">        y22 = np.minimum(y2[i], y2[index[<span class="number">1</span>:]])</span><br><span class="line">        w = np.maximum(<span class="number">0</span>, x22 - x11 + <span class="number">1</span>)</span><br><span class="line">        h = np.maximum(<span class="number">0</span>, y22 - y11 + <span class="number">1</span>)</span><br><span class="line">        overlaps = w * h</span><br><span class="line">        ious = overlaps / (areas[i] + areas[index[<span class="number">1</span>:]] - overlaps)</span><br><span class="line">        <span class="comment"># 只保留满足IOU阈值的索引</span></span><br><span class="line">        idx = np.where(ious &lt;= iou_thresh)[<span class="number">0</span>]</span><br><span class="line">        index = index[idx + <span class="number">1</span>]  <span class="comment"># 处理剩余的边框</span></span><br><span class="line">    bboxes, scores = bboxes[result], scores[result]</span><br><span class="line">    <span class="keyword">return</span> bboxes, scores</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    raw_img = cv2.imread(<span class="string">&#x27;test.png&#x27;</span>)</span><br><span class="line">    <span class="comment"># 这里为了编码方便，将检测的结果直接作为变量</span></span><br><span class="line">    bboxes = [[<span class="number">183</span>, <span class="number">625</span>, <span class="number">269</span>, <span class="number">865</span>], [<span class="number">197</span>, <span class="number">603</span>, <span class="number">296</span>, <span class="number">853</span>], [<span class="number">190</span>, <span class="number">579</span>, <span class="number">295</span>, <span class="number">864</span>], [<span class="number">537</span>, <span class="number">507</span>, <span class="number">618</span>, <span class="number">713</span>], [<span class="number">535</span>, <span class="number">523</span>, <span class="number">606</span>, <span class="number">687</span>]]</span><br><span class="line">    confidences = [<span class="number">0.7</span>, <span class="number">0.9</span>, <span class="number">0.95</span>, <span class="number">0.9</span>, <span class="number">0.6</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 进行nms处理</span></span><br><span class="line">    bboxes, scores = nms(np.array(bboxes), np.array(confidences), <span class="number">0.5</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="mAP"><a href="#mAP" class="headerlink" title="mAP"></a>mAP</h3><p>mean average precision 用于判断模型在目标识别方面的能力。<br>presision &#x3D; TP &#x2F; (TP + FP)   如模型认为positive有100个，其中有80个是对的，就是80 &#x2F;（80+20）     分母是做预测的次数<br>recall &#x3D; TP &#x2F; (TP + FN)      如模型认为positive有100个，而样本总共是200个，就是 100 &#x2F; (80+120)  分母是所有样本的数量</p>
<p>average precision 使用一个IoU阈值划定是否Positive。这样就能计算每次增加一个样本的precision和变动的recall，能绘出曲线。而曲线下的面积是AP，范围0到1.<br>AP(COCO) 考虑不同 IoU 的阈值。一般可能会写成 AP[.50:.05:.95]，代表会分別计算当 IoU &#x3D; 0.5、IoU &#x3D; 0.55、…、IoU &#x3D; 0.9 與 IoU &#x3D; 0.95 的 interpolated AP，最后再将这些 AP 取平均得到最后的 AP。<br>mAP 计算每一个类别的AP之后再平均就是了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://debugtheuniverse.github.io/2024/04/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89%E5%B8%B8%E7%94%A8%E6%A6%82%E5%BF%B5/" data-id="clvg47z9y000320ukejde13dg" data-title="计算机视觉常用概念" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-目标识别" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/04/20/%E7%9B%AE%E6%A0%87%E8%AF%86%E5%88%AB/" class="article-date">
  <time class="dt-published" datetime="2024-04-20T09:13:48.789Z" itemprop="datePublished">2024-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/04/20/%E7%9B%AE%E6%A0%87%E8%AF%86%E5%88%AB/">目标识别</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Deep-Residual-Learning-for-Image-Recognition"><a href="#Deep-Residual-Learning-for-Image-Recognition" class="headerlink" title="Deep Residual Learning for Image Recognition"></a>Deep Residual Learning for Image Recognition</h3><p>Kaiming He大神2015发表</p>
<h4 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h4><p>越深的model越难训练。而大神的方法可以比以前网络更深（152层）的同时还易于optimize。</p>
<h4 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h4><p>深度学习刚开始认为model层数越多越好，然后发现到一定程度增加层数会有退化degradation的效果，所谓梯度消失&#x2F;爆炸问题。<br>所以这里提出的方法是F(x)+x，在网络中就相当于增加可以跨越一层或者多层的捷径，关键是这操作还不需要增加模型参数和计算复杂度。<br>摆试验结论：对照组层数增加误差增加，而resnet轻松享受增加层数带来的好处</p>
<h4 id="试验结果"><a href="#试验结果" class="headerlink" title="试验结果"></a>试验结果</h4><p>单模型resnet152的top-5 error达到了4.49%，6个不同深度的模型组合达到了 3.57%<br>普通网络18层精度比34层高。而resnet18比普通18收敛快。<br>resnet1202比resnet101差，可能是因为参数相对于数据集太大导致。</p>
<h3 id="PVANet-Lightweight-Deep-Neural-Networks-for-Real-time-Object-Detection"><a href="#PVANet-Lightweight-Deep-Neural-Networks-for-Real-time-Object-Detection" class="headerlink" title="PVANet : Lightweight Deep Neural Networks for Real-time Object Detection"></a>PVANet : Lightweight Deep Neural Networks for Real-time Object Detection</h3><p>Sanghoon Hong 2016发表</p>
<h4 id="Abstract-1"><a href="#Abstract-1" class="headerlink" title="Abstract"></a>Abstract</h4><p>减少计算量的情况下提高多类别分类任务精度，使用less channels with more layers。结果是voc2007的mAP达83.8%，voc2012达82.5%（第二）。计算量是resnet101的12.3%。</p>
<h3 id="Rich-feature-hierarchies-for-accurate-object-detection-and-semantic-segmentation-RCNN"><a href="#Rich-feature-hierarchies-for-accurate-object-detection-and-semantic-segmentation-RCNN" class="headerlink" title="Rich feature hierarchies for accurate object detection and semantic segmentation (RCNN)"></a>Rich feature hierarchies for accurate object detection and semantic segmentation (RCNN)</h3><p>Ross Girshick 2014发表</p>
<h4 id="Abstract-2"><a href="#Abstract-2" class="headerlink" title="Abstract"></a>Abstract</h4><p>提出方法比先前的组合模型在VOC2012提高mAP约30%，达到53.3%。</p>
<h4 id="Introduction-1"><a href="#Introduction-1" class="headerlink" title="Introduction"></a>Introduction</h4><p>关注如何用一个深层模型来定位目标，仅使用少量标注检测数据训练一个高容量的模型<br>定位此前滑动窗口被用了近20年，最佳模型OverFeat在ILSVRC2013的mAP是24.3%，而rcnn达到了31.4%。<br>有监督的预训练加上特定领域的微调。</p>
<ol>
<li>输入图片</li>
<li>提取约2000个与类别无关的proposals</li>
<li>使用一个大CNN模型提取每个proposal的特征</li>
<li>使用特定类别的SVM对proposals进行分类</li>
</ol>
<h4 id="bbox-regression"><a href="#bbox-regression" class="headerlink" title="bbox regression"></a>bbox regression</h4><p>将预测的bbox P与gt的bbox G之间做一个映射<br>G_x &#x3D; P_w * d_x(P) + P_x<br>G_y &#x3D; P_h * d_y(P) + P_y<br>G_w &#x3D; P_w * exp(d_w(P))<br>G_h &#x3D; P_h * exp(d_h(P))</p>
<p>第pool5特征的线性函数<br>d_#(P) &#x3D; w_#^T * phi_5(P)  其中#表示x,y,w,h</p>
<p>用ridge regression学习w_#，而其target<br>t_x &#x3D; (G_x - P_x)&#x2F;P_w<br>t_y &#x3D; (G_y - P_y)&#x2F;P_h<br>t_w &#x3D; log(G_w&#x2F;P_w)<br>t_h &#x3D; log(G_h&#x2F;P_h)</p>
<p>只对与gt的IoU高于0.6的P进行学习，其他的丢弃</p>
<h3 id="Spatial-Pyramid-Pooling-in-Deep-Convolutional-Networks-for-Visual-Recognition"><a href="#Spatial-Pyramid-Pooling-in-Deep-Convolutional-Networks-for-Visual-Recognition" class="headerlink" title="Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition"></a>Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition</h3><p>Kaiming He 2014发布<br>SPP-net可以确保输出的尺寸不变，不管输入图片的尺寸。这个方法只计算一次特征图，然后对随机区域pool到固定长度的representation，然后训练detector。<br>实现比RCNN快24-102倍情况下效果还略好。<br>对特征图分别进行全部pool得1个256维的向量，再分4块pool得4个256维向量，再分16块pool得到16个256维向量，把这些向量组合起来，得到21*256维的向量（固定长度），再接全连接层。</p>
<h3 id="Fast-R-CNN-Ross-Girshick"><a href="#Fast-R-CNN-Ross-Girshick" class="headerlink" title="Fast R-CNN Ross Girshick"></a>Fast R-CNN Ross Girshick</h3><p>训练VGG比R-CNN快9倍，测试快213倍，精度还要高些。比SPPnet训练3倍，测试快10倍，精度也高些。<br>一个模型直接包括定位和识别。<br>RCNN慢是因为每次都需要重新计算特征图，而SPPnet一次计算特征图有共享的效果所以快。这两种方法也都是需要分步操作的。</p>
<ol>
<li>输入图像和多个roi到全卷积网络FCN，输入的ROI被prejecting到特征图上面的roi。</li>
<li>对特征图roi进行pool到固定尺寸，再使用全连接层FCs变成特征</li>
<li>每个特征roi都最终连了两个输出：softmax probabilities、per-class bbox regression offsets</li>
<li>使用多任务loss进行end-to-end 训练。</li>
</ol>
<p>Truncated SVD减少推理时间30%。</p>
<h3 id="Faster-R-CNN-Towards-Real-Time-Object-Detection-with-Region-Proposal-Networks"><a href="#Faster-R-CNN-Towards-Real-Time-Object-Detection-with-Region-Proposal-Networks" class="headerlink" title="Faster R-CNN: Towards Real-Time Object Detection with Region Proposal Networks"></a>Faster R-CNN: Towards Real-Time Object Detection with Region Proposal Networks</h3><p>Shaoqing Ren 2015<br>提出RPN网络，将全卷积的特征与检测分享，同时给出目标位置和类别分数，达到接近零cost的proposal。拿下ILSVRC and COCO的2015第一名。</p>
<p>在共享的特征图的最后一层上，用一个nxn的窗口进行滑动（3x3感受野约171ZF和228VGG）,nxn进行卷积引出两个分支cls和reg，每个窗口设定了最大proposal数量k，因此cls为是目标或不是目标2个因此是2k个，而reg就是4k个了</p>
<h3 id="You-Only-Look-Once-Unified-Real-Time-Object-Detection"><a href="#You-Only-Look-Once-Unified-Real-Time-Object-Detection" class="headerlink" title="You Only Look Once: Unified, Real-Time Object Detection"></a>You Only Look Once: Unified, Real-Time Object Detection</h3><p>Joseph Redmon 2015<br>将目标检测问题构建为regression用以获得分离的边界框类别概率。极快。相较于其他方法的定位精度稍逊，但不太可能误判背景。</p>
<ol>
<li>resize输入到448x448</li>
<li>运行cnn</li>
<li>根据模型的confidence对检测结果进行阈值处理</li>
</ol>
<p>YOLO看全局信息，比fast rcnn少一半的背景误差。</p>
<p>将输入图片划分为SxS的grid，每个grid预测B个bbox和C个概率，因此编成S * S * (B<em>5 + C)的预测<br>每个bbox后面附赠一个有目标的confidence，因此是B</em>5<br>类别数量C</p>
<p>YOLO的泛化性能强。即只在VOC2007训练，然后在Picasso dataset和people-art dataset做测试，比R-CNN强（而R-CNN在VOC2007的mAP最高）</p>
<h3 id="Inside-Outside-Net-Detecting-Objects-in-Context-with-Skip-Pooling-and-Recurrent-Neural-Networks"><a href="#Inside-Outside-Net-Detecting-Objects-in-Context-with-Skip-Pooling-and-Recurrent-Neural-Networks" class="headerlink" title="Inside-Outside Net: Detecting Objects in Context with Skip Pooling and Recurrent Neural Networks"></a>Inside-Outside Net: Detecting Objects in Context with Skip Pooling and Recurrent Neural Networks</h3><p>Sean Bell 2015<br>PASCAL VOC 2012的mAP达到76.4%，在MS COCO dataset，mAP有33.1%<br>将roi外部的contextual信息用RNNs考虑进来，其余部分有点像SPPnet的操作+RCNN的detection</p>
<h3 id="R-FCN-Object-Detection-via-Region-based-Fully-Convolutional-Networks"><a href="#R-FCN-Object-Detection-via-Region-based-Fully-Convolutional-Networks" class="headerlink" title="R-FCN: Object Detection via Region-based Fully Convolutional Networks"></a>R-FCN: Object Detection via Region-based Fully Convolutional Networks</h3><p>Jifeng Dai</p>
<p>VOC2007的mAP达83.6%，比Faster R-CNN快2.5-40倍</p>
<h3 id="SSD-Single-Shot-MultiBox-Detector"><a href="#SSD-Single-Shot-MultiBox-Detector" class="headerlink" title="SSD: Single Shot MultiBox Detector"></a>SSD: Single Shot MultiBox Detector</h3><p>Wei Liu</p>
<p>voc2007达到mAP 72.1%，比Faster rcnn快<br>有8x8和4x4的特征图grid，在每一个位置有几个不同长宽比的默认框，将其与gt框重叠的为positive，其余作为negative，每个框有4个坐标和c个confidence</p>
<h3 id="YOLO9000-YOLO-V2"><a href="#YOLO9000-YOLO-V2" class="headerlink" title="YOLO9000 (YOLO V2)"></a>YOLO9000 (YOLO V2)</h3><p>应用了BN，提高了输入resolution，不限定输入图像尺寸，等操作，better、faster、stronger</p>
<h3 id="YOLOv3"><a href="#YOLOv3" class="headerlink" title="YOLOv3"></a>YOLOv3</h3><p>借鉴Resnet设计的darknet53，提高了小目标检测能力；增加了多尺度特征融合，即下采样和上采样融合。将softmax改为logistic支持多标签。<br>YOLO原作者因为技术被用作军事和隐私而退出。</p>
<h3 id="YOLOv4"><a href="#YOLOv4" class="headerlink" title="YOLOv4"></a>YOLOv4</h3><p>ultralytics 增加了一些功能，权序列连接 (WRC)、跨阶段部分连接 (CSP)、交叉迷你批归一化 (CmBN)、自对抗训练 (SAT)、误激活、马赛克数据增强、DropBlock 正则化和 CIoU 损失</p>
<h3 id="YOLOv5"><a href="#YOLOv5" class="headerlink" title="YOLOv5"></a>YOLOv5</h3><p>ultralytics 无锚点分割Ultralytics Head，优化准确性与速度之间的权衡，多种预训练模型</p>
<h3 id="YOLOv6"><a href="#YOLOv6" class="headerlink" title="YOLOv6"></a>YOLOv6</h3><p>美团<br>双向串行 (BiC) 模块：YOLOv6 在探测器的颈部引入了双向并联（BiC）模块，可增强定位信号并提高性能，而速度降低可忽略不计。<br>锚点辅助训练（AAT）策略：该模型提出的 AAT 可同时享受基于锚和无锚范式的优势，而不会降低推理效率。<br>增强型骨干和颈部设计：通过深化 YOLOv6，在骨干和颈部加入另一个阶段，该模型在高分辨率输入的 COCO 数据集上实现了最先进的性能。<br>自蒸馏策略：为了提高 YOLOv6 较小模型的性能，我们采用了一种新的自蒸馏策略，在训练过程中增强辅助回归分支，在推理过程中去除辅助回归分支，以避免速度明显下降。</p>
<h3 id="YOLOv7-Trainable-bag-of-freebies-sets-new-state-of-the-art-for-real-time-object-detectors"><a href="#YOLOv7-Trainable-bag-of-freebies-sets-new-state-of-the-art-for-real-time-object-detectors" class="headerlink" title="YOLOv7: Trainable bag-of-freebies sets new state-of-the-art for real-time object detectors"></a>YOLOv7: Trainable bag-of-freebies sets new state-of-the-art for real-time object detectors</h3><p>Chien-Yao Wang 2022<br>模型重新参数化：YOLOv7 提出了一种有计划的重新参数化模型，这是一种适用于不同网络层的策略，具有梯度传播路径的概念。</p>
<p>动态标签分配：多输出层模型的训练提出了一个新问题：”如何为不同分支的输出分配动态目标？为了解决这个问题，YOLOv7 引入了一种新的标签分配方法，即从粗到细的引导标签分配法。</p>
<p>扩展和复合缩放YOLOv7 为实时对象检测器提出了 “扩展 “和 “复合缩放 “方法，可有效利用参数和计算。</p>
<p>效率：YOLOv7 提出的方法能有效减少最先进的实时物体检测器约 40% 的参数和 50% 的计算量，推理速度更快，检测精度更高。</p>
<h3 id="YOLOv8"><a href="#YOLOv8" class="headerlink" title="YOLOv8"></a>YOLOv8</h3><p>Ultralytics<br>先进的骨干和颈部架构： YOLOv8 采用了最先进的骨干和颈部架构，从而提高了特征提取和物体检测性能。<br>无锚分裂Ultralytics 头： YOLOv8 采用无锚分裂Ultralytics 头，与基于锚的方法相比，它有助于提高检测过程的准确性和效率。<br>优化精度与速度之间的权衡： YOLOv8 专注于保持精度与速度之间的最佳平衡，适用于各种应用领域的实时目标检测任务。<br>各种预训练模型： YOLOv8 提供一系列预训练模型，以满足各种任务和性能要求，从而更容易为您的特定用例找到合适的模型。</p>
<h3 id="YOLOv9"><a href="#YOLOv9" class="headerlink" title="YOLOv9"></a>YOLOv9</h3><p>YOLOv9 在其架构中加入了可逆函数，以降低信息退化的风险<br>PGI 是 YOLOv9 为解决信息瓶颈问题而引入的一个新概念，可确保在深层网络中保留重要数据。这样就能生成可靠的梯度，促进模型的准确更新，提高整体检测性能。<br>GELAN 是一项战略性的架构进步，使 YOLOv9 能够实现更高的参数利用率和计算效率。<br>YOLOv9c 模型尤其凸显了架构优化的有效性。与 YOLOv7 AF 相比，它的运行参数减少了 42%，计算需求减少了 21%，但精度却不相上下，这表明 YOLOv9 的效率有了显著提高。此外，YOLOv9e 模型还为大型模型设立了新标准，其参数比 YOLOv7 AF 少 15%，计算需求比 YOLOv7 AF 少 25%。 YOLOv8x相比，参数减少了 15%，计算需求减少了 25%，同时 AP 增量提高了 1.7%。<br>这些结果展示了 YOLOv9 在模型设计方面的战略性进步，强调了它在提高效率的同时并没有降低实时物体检测任务所必需的精度。该模型不仅突破了性能指标的界限，而且强调了计算效率的重要性，使其成为计算机视觉领域的一项关键性发展。</p>
<h3 id="Segment-Anything"><a href="#Segment-Anything" class="headerlink" title="Segment Anything"></a>Segment Anything</h3><p>Alexander Kirillov 2023<br>在大语言模型中网络级别的大数据训练可以让NLP模型泛化到未见数据。这种容量与prompt engineering常在一起使用。cv目前缺少大量的数据。<br>提出SA-1B分割数据集，比现有任何都大400倍以上</p>
<p>自动标注是SAM 的一项重要功能，允许用户使用预先训练好的检测模型生成分割数据集。这一功能可以快速、准确地标注大量图像，避免了耗时的人工标注。</p>
<h3 id="RT-DTER"><a href="#RT-DTER" class="headerlink" title="RT-DTER"></a>RT-DTER</h3><p>百度 2023<br>极快，效果好的一个detection model</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://debugtheuniverse.github.io/2024/04/20/%E7%9B%AE%E6%A0%87%E8%AF%86%E5%88%AB/" data-id="clvg47z9s000020ukftzs6qae" data-title="目标识别" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-计算机视觉入门" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/04/20/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89%E5%85%A5%E9%97%A8/" class="article-date">
  <time class="dt-published" datetime="2024-04-20T01:07:41.765Z" itemprop="datePublished">2024-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/04/20/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89%E5%85%A5%E9%97%A8/">计算机视觉入门</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="卷积网络图像分类器"><a href="#卷积网络图像分类器" class="headerlink" title="卷积网络图像分类器"></a>卷积网络图像分类器</h3><p>一个卷积神经网络通常包含了base和head两个部分。base是用于提取特征，head用于对特征进行分类（就与机器学习里面的一样）。</p>
<h4 id="读取数据"><a href="#读取数据" class="headerlink" title="读取数据"></a>读取数据</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Imports</span></span><br><span class="line"><span class="keyword">import</span> os, warnings</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> gridspec</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.preprocessing <span class="keyword">import</span> image_dataset_from_directory</span><br><span class="line"></span><br><span class="line"><span class="comment"># Reproducability</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_seed</span>(<span class="params">seed=<span class="number">31415</span></span>):</span><br><span class="line">    np.random.seed(seed)</span><br><span class="line">    tf.random.set_seed(seed)</span><br><span class="line">    os.environ[<span class="string">&#x27;PYTHONHASHSEED&#x27;</span>] = <span class="built_in">str</span>(seed)</span><br><span class="line">    os.environ[<span class="string">&#x27;TF_DETERMINISTIC_OPS&#x27;</span>] = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">set_seed(<span class="number">31415</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set Matplotlib defaults</span></span><br><span class="line">plt.rc(<span class="string">&#x27;figure&#x27;</span>, autolayout=<span class="literal">True</span>)</span><br><span class="line">plt.rc(<span class="string">&#x27;axes&#x27;</span>, labelweight=<span class="string">&#x27;bold&#x27;</span>, labelsize=<span class="string">&#x27;large&#x27;</span>,</span><br><span class="line">       titleweight=<span class="string">&#x27;bold&#x27;</span>, titlesize=<span class="number">18</span>, titlepad=<span class="number">10</span>)</span><br><span class="line">plt.rc(<span class="string">&#x27;image&#x27;</span>, cmap=<span class="string">&#x27;magma&#x27;</span>)</span><br><span class="line">warnings.filterwarnings(<span class="string">&quot;ignore&quot;</span>) <span class="comment"># to clean up output cells</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load training and validation sets</span></span><br><span class="line">ds_train_ = image_dataset_from_directory(</span><br><span class="line">    <span class="string">&#x27;../input/car-or-truck/train&#x27;</span>,</span><br><span class="line">    labels=<span class="string">&#x27;inferred&#x27;</span>,</span><br><span class="line">    label_mode=<span class="string">&#x27;binary&#x27;</span>,</span><br><span class="line">    image_size=[<span class="number">128</span>, <span class="number">128</span>],</span><br><span class="line">    interpolation=<span class="string">&#x27;nearest&#x27;</span>,</span><br><span class="line">    batch_size=<span class="number">64</span>,</span><br><span class="line">    shuffle=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line">ds_valid_ = image_dataset_from_directory(</span><br><span class="line">    <span class="string">&#x27;../input/car-or-truck/valid&#x27;</span>,</span><br><span class="line">    labels=<span class="string">&#x27;inferred&#x27;</span>,</span><br><span class="line">    label_mode=<span class="string">&#x27;binary&#x27;</span>,</span><br><span class="line">    image_size=[<span class="number">128</span>, <span class="number">128</span>],</span><br><span class="line">    interpolation=<span class="string">&#x27;nearest&#x27;</span>,</span><br><span class="line">    batch_size=<span class="number">64</span>,</span><br><span class="line">    shuffle=<span class="literal">False</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Data Pipeline</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_to_float</span>(<span class="params">image, label</span>):</span><br><span class="line">    image = tf.image.convert_image_dtype(image, dtype=tf.float32)</span><br><span class="line">    <span class="keyword">return</span> image, label</span><br><span class="line"></span><br><span class="line">AUTOTUNE = tf.data.experimental.AUTOTUNE</span><br><span class="line">ds_train = (</span><br><span class="line">    ds_train_</span><br><span class="line">    .<span class="built_in">map</span>(convert_to_float)</span><br><span class="line">    .cache()</span><br><span class="line">    .prefetch(buffer_size=AUTOTUNE)</span><br><span class="line">)</span><br><span class="line">ds_valid = (</span><br><span class="line">    ds_valid_</span><br><span class="line">    .<span class="built_in">map</span>(convert_to_float)</span><br><span class="line">    .cache()</span><br><span class="line">    .prefetch(buffer_size=AUTOTUNE)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="读取预训练base"><a href="#读取预训练base" class="headerlink" title="读取预训练base"></a>读取预训练base</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pretrained_base = tf.keras.models.load_model(</span><br><span class="line">    <span class="string">&#x27;../input/cv-course-models/cv-course-models/vgg16-pretrained-base&#x27;</span>,</span><br><span class="line">)</span><br><span class="line">pretrained_base.trainable = <span class="literal">False</span> <span class="comment"># 直接使用在大规模数据训练好的head也叫Transfer Learning，不在小规模数据中改动</span></span><br></pre></td></tr></table></figure>

<h4 id="接上head后训练"><a href="#接上head后训练" class="headerlink" title="接上head后训练"></a>接上head后训练</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> layers</span><br><span class="line"></span><br><span class="line">model = keras.Sequential([</span><br><span class="line">    pretrained_base,</span><br><span class="line">    layers.Flatten(),</span><br><span class="line">    layers.Dense(<span class="number">6</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    layers.Dense(<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>),</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">model.<span class="built_in">compile</span>(</span><br><span class="line">    optimizer=<span class="string">&#x27;adam&#x27;</span>,</span><br><span class="line">    loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>,</span><br><span class="line">    metrics=[<span class="string">&#x27;binary_accuracy&#x27;</span>],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">history = model.fit(</span><br><span class="line">    ds_train,</span><br><span class="line">    validation_data=ds_valid,</span><br><span class="line">    epochs=<span class="number">30</span>,</span><br><span class="line">    verbose=<span class="number">0</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">history_frame = pd.DataFrame(history.history)</span><br><span class="line">history_frame.loc[:, [<span class="string">&#x27;loss&#x27;</span>, <span class="string">&#x27;val_loss&#x27;</span>]].plot()</span><br><span class="line">history_frame.loc[:, [<span class="string">&#x27;binary_accuracy&#x27;</span>, <span class="string">&#x27;val_binary_accuracy&#x27;</span>]].plot()</span><br></pre></td></tr></table></figure>

<h4 id="filter-detect-condense"><a href="#filter-detect-condense" class="headerlink" title="filter detect condense"></a>filter detect condense</h4><p>在head中，使用filters对input图像进行过滤，然后使用relu实现detect效果，再用maxpooling实现condense<br>先relu后maxpooling就有intensifying的效果</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> layers</span><br><span class="line"></span><br><span class="line">model = keras.Sequential([</span><br><span class="line">    layers.Conv2D(filters=<span class="number">64</span>, kernel_size=<span class="number">3</span>), <span class="comment"># activation is None</span></span><br><span class="line">    layers.MaxPool2D(pool_size=<span class="number">2</span>),</span><br><span class="line">    <span class="comment"># More layers follow</span></span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<h4 id="Maxpooling-具有平移不变性"><a href="#Maxpooling-具有平移不变性" class="headerlink" title="Maxpooling 具有平移不变性"></a>Maxpooling 具有平移不变性</h4><p>原理是将shape以内的最大数据作为shape的新数据，因此对于最大值所在的位置是不在乎的，因此位置不敏感了</p>
<h4 id="关于滑动窗口"><a href="#关于滑动窗口" class="headerlink" title="关于滑动窗口"></a>关于滑动窗口</h4><p>特征提取过程有：1. 使用conv层filter；2. 使用relu层detect；3. 使用maximum pooling来condense<br>其中，conv和maximum的操作都是按照滑动窗口来实现的。<br>滑动窗口大小由<code>kernel_size</code>给定，每次滑动距离由<code>strides</code>给定，使用何种类型边缘处理由<code>padding</code>给定。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> layers</span><br><span class="line"></span><br><span class="line">model = keras.Sequential([</span><br><span class="line">    layers.Conv2D(filters=<span class="number">64</span>,</span><br><span class="line">                  kernel_size=<span class="number">3</span>,</span><br><span class="line">                  strides=<span class="number">1</span>,</span><br><span class="line">                  padding=<span class="string">&#x27;same&#x27;</span>,</span><br><span class="line">                  activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    layers.MaxPool2D(pool_size=<span class="number">2</span>,</span><br><span class="line">                     strides=<span class="number">1</span>,</span><br><span class="line">                     padding=<span class="string">&#x27;same&#x27;</span>)</span><br><span class="line">    <span class="comment"># More layers follow</span></span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<p>为了获得更多的特征用于分类，conv的strides一般是（1，1）。而maximum pooling的strides通常为（2，2），（3，3）而不超过窗口本身。</p>
<p>边界处理使用<code>padding=&#39;valid&#39;</code>会让conv完全在图内部运行，会导致输出尺寸缩小。使用<code>padding=&#39;same&#39;</code>会在输入图像周围加上几圈0，使得输出尺寸不变。</p>
<h4 id="感受野-receptive-field"><a href="#感受野-receptive-field" class="headerlink" title="感受野 receptive field"></a>感受野 receptive field</h4><p>多层conv和maximum pooling后的一个unit对应input的区域</p>
<h3 id="数据扩增-Data-Augmentation"><a href="#数据扩增-Data-Augmentation" class="headerlink" title="数据扩增 Data Augmentation"></a>数据扩增 Data Augmentation</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> layers</span><br><span class="line"><span class="comment"># these are a new feature in TF 2.2</span></span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers.experimental <span class="keyword">import</span> preprocessing</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pretrained_base = tf.keras.models.load_model(</span><br><span class="line">    <span class="string">&#x27;../input/cv-course-models/cv-course-models/vgg16-pretrained-base&#x27;</span>,</span><br><span class="line">)</span><br><span class="line">pretrained_base.trainable = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">model = keras.Sequential([</span><br><span class="line">    <span class="comment"># Preprocessing</span></span><br><span class="line">    preprocessing.RandomFlip(<span class="string">&#x27;horizontal&#x27;</span>), <span class="comment"># flip left-to-right</span></span><br><span class="line">    preprocessing.RandomContrast(<span class="number">0.5</span>), <span class="comment"># contrast change by up to 50%</span></span><br><span class="line">    <span class="comment"># Base</span></span><br><span class="line">    pretrained_base,</span><br><span class="line">    <span class="comment"># Head</span></span><br><span class="line">    layers.Flatten(),</span><br><span class="line">    layers.Dense(<span class="number">6</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    layers.Dense(<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>),</span><br><span class="line">])</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://debugtheuniverse.github.io/2024/04/20/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89%E5%85%A5%E9%97%A8/" data-id="clvg47z9x000220uk6dm887i1" data-title="计算机视觉入门" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-深度学习入门" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/04/18/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/" class="article-date">
  <time class="dt-published" datetime="2024-04-18T10:48:46.899Z" itemprop="datePublished">2024-04-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/04/18/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/">深度学习入门</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="最简单的神经元模型"><a href="#最简单的神经元模型" class="headerlink" title="最简单的神经元模型"></a>最简单的神经元模型</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">red_wine = pd.read_csv(<span class="string">&#x27;../input/dl-course-data/red-wine.csv&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(red_wine.shape)   <span class="comment"># (1599,12)</span></span><br><span class="line"></span><br><span class="line">model = keras.Sequential([</span><br><span class="line">    layers.Dense(units=<span class="number">1</span>, input_shape=[<span class="number">11</span>]),</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">x = tf.linspace(-<span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">100</span>)</span><br><span class="line">y = model.predict(x)</span><br><span class="line"></span><br><span class="line">w, b = model.weights</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;weights\n&#123;&#125;\nBias\n&#123;&#125;&quot;</span>.<span class="built_in">format</span>(w,b))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="深度神经元模型"><a href="#深度神经元模型" class="headerlink" title="深度神经元模型"></a>深度神经元模型</h3><h4 id="建立Sequential-Model"><a href="#建立Sequential-Model" class="headerlink" title="建立Sequential Model"></a>建立Sequential Model</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow <span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras <span class="keyword">import</span> layers</span><br><span class="line"></span><br><span class="line">model = keras.Sequential([  <span class="comment"># 所有层都放在一个list中</span></span><br><span class="line">    <span class="comment"># the hidden ReLU layers</span></span><br><span class="line">    layers.Dense(units=<span class="number">4</span>, activation=<span class="string">&#x27;relu&#x27;</span>, input_shape=[<span class="number">2</span>]),</span><br><span class="line">    layers.Dense(units=<span class="number">3</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    <span class="comment"># the linear output layer </span></span><br><span class="line">    layers.Dense(units=<span class="number">1</span>),</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<p>把Activation单独作为层来写</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">model = keras.Sequential([</span><br><span class="line">    layers.Dense(<span class="number">32</span>, input_shape=[<span class="number">8</span>]),</span><br><span class="line">    layers.Activation(<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    layers.Dense(<span class="number">32</span>),</span><br><span class="line">    layers.Activation(<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    layers.Dense(<span class="number">1</span>),</span><br><span class="line">])</span><br></pre></td></tr></table></figure>

<h4 id="损失函数-Loss-Function"><a href="#损失函数-Loss-Function" class="headerlink" title="损失函数 Loss Function"></a>损失函数 Loss Function</h4><p>描述预测值与真实值之间的差距的一个算法，对于Regression任务的例子有MAE和MSE等</p>
<h4 id="优化器-Optimizer"><a href="#优化器-Optimizer" class="headerlink" title="优化器 Optimizer"></a>优化器 Optimizer</h4><p>调节模型权重以尽快减小Loss的算法<br>如随机梯度下降Stochastic Gradient Decent</p>
<ol>
<li>随机取样一些训练数据（数量为minibatch 或 batch），经过model得到predict</li>
<li>算出loss</li>
<li>向loss减小的方向（梯度）调节weights</li>
</ol>
<p>所有数据都过一遍model叫做一个epoch</p>
<h4 id="学习率-Learning-Rate-和-Batch-Size"><a href="#学习率-Learning-Rate-和-Batch-Size" class="headerlink" title="学习率 Learning Rate 和 Batch Size"></a>学习率 Learning Rate 和 Batch Size</h4><p>学习率和Batch Size决定SGD以多大步子和速度进行，通常不是显而易见的。<br>为此，Adam是一种自适应的SGD算法，不需要调参。</p>
<h4 id="为模型增加Loss和Optimizer"><a href="#为模型增加Loss和Optimizer" class="headerlink" title="为模型增加Loss和Optimizer"></a>为模型增加Loss和Optimizer</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">model.<span class="built_in">compile</span>(</span><br><span class="line">    opertimizer=<span class="string">&#x27;adam&#x27;</span>,</span><br><span class="line">    loss=<span class="string">&#x27;mae&#x27;</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="训练fit"><a href="#训练fit" class="headerlink" title="训练fit"></a>训练fit</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">history = model.fit(</span><br><span class="line">    X_train, y_train,</span><br><span class="line">    validation_data=(X_valid, y_valid),</span><br><span class="line">    batch_size=<span class="number">256</span>,</span><br><span class="line">    epochs=<span class="number">10</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="查看loss"><a href="#查看loss" class="headerlink" title="查看loss"></a>查看loss</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># convert the training history to a dataframe</span></span><br><span class="line">history_df = pd.DataFrame(history.history)</span><br><span class="line"><span class="comment"># use Pandas native plot method</span></span><br><span class="line">history_df[<span class="string">&#x27;loss&#x27;</span>].plot();</span><br></pre></td></tr></table></figure>

<h3 id="Overfitting-和-Underfitting"><a href="#Overfitting-和-Underfitting" class="headerlink" title="Overfitting 和 Underfitting"></a>Overfitting 和 Underfitting</h3><p>训练数据中的信息由有用信号和噪声组成。理想模型是学习所有信号而没有噪声，但是实际上不存在。</p>
<h4 id="信号不够为Underfitting-增加模型容量Capacity，增宽增深"><a href="#信号不够为Underfitting-增加模型容量Capacity，增宽增深" class="headerlink" title="信号不够为Underfitting,增加模型容量Capacity，增宽增深"></a>信号不够为Underfitting,增加模型容量Capacity，增宽增深</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">model = keras.Sequential([</span><br><span class="line">    layers.Dense(<span class="number">16</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    layers.Dense(<span class="number">1</span>),</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">wider = keras.Sequential([</span><br><span class="line">    layers.Dense(<span class="number">32</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    layers.Dense(<span class="number">1</span>),</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">deeper = keras.Sequential([</span><br><span class="line">    layers.Dense(<span class="number">16</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    layers.Dense(<span class="number">16</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">    layers.Dense(<span class="number">1</span>),</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<h4 id="噪声过多Overfitting"><a href="#噪声过多Overfitting" class="headerlink" title="噪声过多Overfitting"></a>噪声过多Overfitting</h4><p>在valid Loss开始上升时Early Stop</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tensorflow.keras.callbacks <span class="keyword">import</span> EarlyStopping</span><br><span class="line"></span><br><span class="line">early_stopping = EarlyStopping(</span><br><span class="line">    min_delta=<span class="number">0.001</span>, <span class="comment"># minimium amount of change(validation loss) to count as an improvement</span></span><br><span class="line">    patience=<span class="number">20</span>, <span class="comment"># how many epochs to wait before stopping</span></span><br><span class="line">    restore_best_weights=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">history = model.fit(</span><br><span class="line">    X_train, y_train,</span><br><span class="line">    validation_data=(X_valid, y_valid),</span><br><span class="line">    batch_size=<span class="number">256</span>,</span><br><span class="line">    epochs=<span class="number">500</span>,</span><br><span class="line">    callbacks=[early_stopping], <span class="comment"># put your callbacks in a list  每epoch都会调用一次callback</span></span><br><span class="line">    verbose=<span class="number">0</span>,  <span class="comment"># turn off training log</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">history_df = pd.DataFrame(history.history)</span><br><span class="line">history_df.loc[:, [<span class="string">&#x27;loss&#x27;</span>, <span class="string">&#x27;val_loss&#x27;</span>]].plot();</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Minimum validation loss: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(history_df[<span class="string">&#x27;val_loss&#x27;</span>].<span class="built_in">min</span>()))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="使用Dropout减少Overfitting"><a href="#使用Dropout减少Overfitting" class="headerlink" title="使用Dropout减少Overfitting"></a>使用Dropout减少Overfitting</h4><p>Dropout让层间连接随机断开一些，直接加到你需要断开的层前面去</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">keras.Sequential([</span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    layers.Dropout(rate=<span class="number">0.3</span>), <span class="comment"># apply 30% dropout to the next layer</span></span><br><span class="line">    layers.Dense(<span class="number">16</span>),</span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<h4 id="Batch-Normalization"><a href="#Batch-Normalization" class="headerlink" title="Batch Normalization"></a>Batch Normalization</h4><p>用每一个batch数据自身的mean和deviation做normalization，还用两个可训练的参数把数据缩放到新尺度。<br>使用时适当增加网络units数量</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接在层后添加</span></span><br><span class="line">layers.Dense(<span class="number">16</span>, activation=<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line">layers.BatchNormalization(),</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在激活函数前添加</span></span><br><span class="line">layers.Dense(<span class="number">16</span>),</span><br><span class="line">layers.BatchNormalization(),</span><br><span class="line">layers.Activation(<span class="string">&#x27;relu&#x27;</span>),</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在第一层添加，相当于自适应的预处理，类似于sklearn的StandardScaler</span></span><br></pre></td></tr></table></figure>

<h3 id="二分类任务-Binary-Classification"><a href="#二分类任务-Binary-Classification" class="headerlink" title="二分类任务 Binary Classification"></a>二分类任务 Binary Classification</h3><p>分类精度是结果，但是不能作为Loss，因为变化是跳跃的。为此，使用cross-entropy，是概率分布的距离表示，预测正确的概率大则loss小。<br>为了将网络输出变为0到1之间的概率表示，就要用到sigmoid这种activation function了。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">model.<span class="built_in">compile</span>(</span><br><span class="line">    optimizer=<span class="string">&#x27;adam&#x27;</span>,</span><br><span class="line">    loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>,</span><br><span class="line">    metrics=[<span class="string">&#x27;binary_accuracy&#x27;</span>], <span class="comment"># 对于二分类 使用binary_accuracy</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://debugtheuniverse.github.io/2024/04/18/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8/" data-id="clv54epb900001suk16z94v78" data-title="深度学习入门" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">weiter &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/08/22/Kalman%E6%BB%A4%E6%B3%A2/">Kalman滤波</a>
          </li>
        
          <li>
            <a href="/2024/05/14/Python%20advanced/">(no title)</a>
          </li>
        
          <li>
            <a href="/2024/05/13/%E9%85%8D%E7%BD%AEQt%E4%B8%8EOpenCV/">配置Qt与OpenCV</a>
          </li>
        
          <li>
            <a href="/2024/05/06/Python%20%E8%B5%8B%E5%80%BC%E5%BC%95%E7%94%A8%E3%80%81%E6%8B%B7%E8%B4%9D/">Python 赋值引用、拷贝</a>
          </li>
        
          <li>
            <a href="/2024/05/04/C++%E5%9F%BA%E7%A1%80/">C++ 基础</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 Jim Huang<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>